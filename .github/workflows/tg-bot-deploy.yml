name: "TG BOT DEPLOY"

on:
  push:
    branches:
      - "main"

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Display event info
        run: |
          echo "üéâ The job was automatically triggered by a push event."
          echo "üêß This job is running on an Ubuntu server hosted by GitHub!"

      - name: List files in the repository
        run: |
          ls
          echo "docker-compose.yaml should be listed above."

      - name: Start services with Docker Compose
        env:
          COINMARKET_API_KEY: ${{ secrets.COINMARKET_API_KEY }}
          BOT_TOKEN: ${{ secrets.BOT_TOKEN }}
          NAVIDROME_URL: ${{ secrets.NAVIDROME_URL }}
        run: |
          docker compose down  # Stop any existing services
          docker compose up -d --build  # Build and run services in detached mode
          echo "üöÄ Your app is now running with Docker Compose!"

      - name: Verify services are running
        run: |
          docker compose ps  # Check the status of all services
          echo "üçè The job's status is ${{ job.status }}."
